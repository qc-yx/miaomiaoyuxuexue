<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šåŠŸèƒ½åº”ç”¨ - GitHub Pagesç‰ˆ</title>
    <link rel="stylesheet" href="styles.css">
    <!-- æ·»åŠ iOSä¼˜åŒ–çš„metaæ ‡ç­¾ -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="å¤šåŠŸèƒ½åº”ç”¨">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“±</text></svg>">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸŒŸ å¤šåŠŸèƒ½åº”ç”¨</h1>
            <p class="subtitle">GitHub Pages çº¯å‰ç«¯ç‰ˆæœ¬</p>
            <div class="auth-status" id="authStatus">
                <span id="currentUser">æ¸¸å®¢</span>
                <button id="logoutBtn" style="display: none;">é€€å‡º</button>
            </div>
        </header>

        <!-- ç™»å½•/æ³¨å†ŒåŒºåŸŸ -->
        <div id="authSection" class="auth-section">
            <div class="auth-tabs">
                <button class="tab-btn active" data-tab="login">ç™»å½•</button>
                <button class="tab-btn" data-tab="register">æ³¨å†Œ</button>
            </div>
            
            <div id="loginTab" class="auth-form">
                <h3>ç”¨æˆ·ç™»å½•</h3>
                <form id="loginForm">
                    <label for="loginUsername" style="display: block; margin-bottom: 5px; font-weight: 600;">ç”¨æˆ·å:</label>
                    <input type="text" id="loginUsername" placeholder="ç”¨æˆ·å" required>
                    <label for="loginPassword" style="display: block; margin-bottom: 5px; font-weight: 600;">å¯†ç :</label>
                    <input type="password" id="loginPassword" placeholder="å¯†ç " required>
                    <button type="submit">ç™»å½•</button>
                </form>
            </div>
            
            <div id="registerTab" class="auth-form" style="display: none;">
                <h3>ç”¨æˆ·æ³¨å†Œ</h3>
                <form id="registerForm">
                    <label for="registerUsername" style="display: block; margin-bottom: 5px; font-weight: 600;">ç”¨æˆ·å:</label>
                    <input type="text" id="registerUsername" placeholder="ç”¨æˆ·å" required>
                    <label for="registerPassword" style="display: block; margin-bottom: 5px; font-weight: 600;">å¯†ç :</label>
                    <input type="password" id="registerPassword" placeholder="å¯†ç " required>
                    <label for="registerConfirmPassword" style="display: block; margin-bottom: 5px; font-weight: 600;">ç¡®è®¤å¯†ç :</label>
                    <input type="password" id="registerConfirmPassword" placeholder="ç¡®è®¤å¯†ç " required>
                    <button type="submit">æ³¨å†Œ</button>
                </form>
            </div>
        </div>

        <!-- ä¸»åŠŸèƒ½åŒºåŸŸ -->
        <div id="mainSection" class="main-section" style="display: none;">
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="lists">ğŸ“‹ å…±äº«æ¸…å•</button>
                <button class="nav-tab" data-tab="notes">ğŸ“ ç¬”è®°</button>
                <button class="nav-tab" data-tab="exercises">ğŸ’ª è¿åŠ¨</button>
                <button class="nav-tab" data-tab="cuisine">ğŸ½ï¸ é¥®é£Ÿ</button>
                <button class="nav-tab" data-tab="wheel">ğŸ² è½¬ç›˜</button>
            </nav>

            <!-- å…±äº«æ¸…å•åŠŸèƒ½ -->
            <div id="listsTab" class="tab-content active">
                <div class="section-header">
                    <h2>ğŸ“‹ å…±äº«æ¸…å•</h2>
                    <button id="createListBtn" class="btn-primary">åˆ›å»ºæ–°æ¸…å•</button>
                </div>
                <div id="listsContainer" class="lists-container"></div>
                
                <!-- åˆ›å»ºæ¸…å•æ¨¡æ€æ¡† -->
                <div id="createListModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h3>åˆ›å»ºæ–°æ¸…å•</h3>
                        <form id="createListForm">
                            <label for="listName" style="display: block; margin-bottom: 5px; font-weight: 600;">æ¸…å•åç§°:</label>
                            <input type="text" id="listName" placeholder="æ¸…å•åç§°" required>
                            <textarea id="listDescription" placeholder="æ¸…å•æè¿°"></textarea>
                            <button type="submit">åˆ›å»ºæ¸…å•</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- ç¬”è®°åŠŸèƒ½ -->
            <div id="notesTab" class="tab-content">
                <div class="section-header">
                    <h2>ğŸ“ ç¬”è®°</h2>
                    <label for="noteDate" style="display: block; margin-bottom: 5px; font-weight: 600;">é€‰æ‹©æ—¥æœŸ:</label>
                    <input type="date" id="noteDate" class="date-input">
                </div>
                <div class="note-editor">
                    <textarea id="noteContent" placeholder="åœ¨è¿™é‡Œå†™ä¸‹æ‚¨çš„ç¬”è®°..." rows="15"></textarea>
                    <div class="note-actions">
                        <button id="saveNoteBtn" class="btn-primary">ä¿å­˜ç¬”è®°</button>
                        <button id="clearNoteBtn" class="btn-secondary">æ¸…ç©º</button>
                    </div>
                </div>
            </div>

            <!-- è¿åŠ¨åŠŸèƒ½ -->
            <div id="exercisesTab" class="tab-content">
                <div class="section-header">
                    <h2>ğŸ’ª è¿åŠ¨è®°å½•</h2>
                    <button id="addExerciseBtn" class="btn-primary">æ·»åŠ è¿åŠ¨</button>
                </div>
                <div id="exercisesContainer" class="exercises-container"></div>
                
                <!-- æ·»åŠ è¿åŠ¨æ¨¡æ€æ¡† -->
                <div id="addExerciseModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h3>æ·»åŠ è¿åŠ¨</h3>
                        <form id="addExerciseForm">
                            <label for="exerciseName" style="display: block; margin-bottom: 5px; font-weight: 600;">è¿åŠ¨åç§°:</label>
                            <input type="text" id="exerciseName" placeholder="è¿åŠ¨åç§°" required>
                            <select id="exerciseType" required>
                                <option value="">é€‰æ‹©ç±»å‹</option>
                                <option value="æœ‰æ°§è¿åŠ¨">æœ‰æ°§è¿åŠ¨</option>
                                <option value="åŠ›é‡è®­ç»ƒ">åŠ›é‡è®­ç»ƒ</option>
                                <option value="æŸ”éŸ§æ€§">æŸ”éŸ§æ€§</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                            <label for="exerciseDuration" style="display: block; margin-bottom: 5px; font-weight: 600;">æŒç»­æ—¶é—´(åˆ†é’Ÿ):</label>
                            <input type="number" id="exerciseDuration" placeholder="æŒç»­æ—¶é—´(åˆ†é’Ÿ)" min="1" required>
                            <select id="exerciseIntensity" required>
                                <option value="">é€‰æ‹©å¼ºåº¦</option>
                                <option value="ä½">ä½</option>
                                <option value="ä¸­">ä¸­</option>
                                <option value="é«˜">é«˜</option>
                            </select>
                            <button type="submit">æ·»åŠ è¿åŠ¨</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- é¥®é£ŸåŠŸèƒ½ -->
            <div id="cuisineTab" class="tab-content">
                <div class="section-header">
                    <h2>ğŸ½ï¸ é¥®é£Ÿè®°å½•</h2>
                    <button id="addCuisineBtn" class="btn-primary">æ·»åŠ é¥®é£Ÿ</button>
                </div>
                <div id="cuisineContainer" class="cuisine-container"></div>
                
                <!-- æ·»åŠ é¥®é£Ÿæ¨¡æ€æ¡† -->
                <div id="addCuisineModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h3>æ·»åŠ é¥®é£Ÿ</h3>
                        <form id="addCuisineForm">
                            <label for="cuisineName" style="display: block; margin-bottom: 5px; font-weight: 600;">é£Ÿç‰©åç§°:</label>
                            <input type="text" id="cuisineName" placeholder="é£Ÿç‰©åç§°" required>
                            <select id="cuisineType" required>
                                <option value="">é€‰æ‹©ç±»å‹</option>
                                <option value="æ—©é¤">æ—©é¤</option>
                                <option value="åˆé¤">åˆé¤</option>
                                <option value="æ™šé¤">æ™šé¤</option>
                                <option value="é›¶é£Ÿ">é›¶é£Ÿ</option>
                                <option value="å…¶ä»–">å…¶ä»–</option>
                            </select>
                            <label for="cuisineCalories" style="display: block; margin-bottom: 5px; font-weight: 600;">å¡è·¯é‡Œ:</label>
                            <input type="number" id="cuisineCalories" placeholder="å¡è·¯é‡Œ" min="0" required>
                            <label for="cuisineDate" style="display: block; margin-bottom: 5px; font-weight: 600;">æ—¥æœŸ:</label>
                            <input type="date" id="cuisineDate" required>
                            <button type="submit">æ·»åŠ é¥®é£Ÿ</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- è½¬ç›˜åŠŸèƒ½ -->
            <div id="wheelTab" class="tab-content">
                <div class="section-header">
                    <h2>ğŸ² è½¬ç›˜</h2>
                    <button id="createWheelBtn" class="btn-primary">åˆ›å»ºè½¬ç›˜</button>
                </div>
                <div id="wheelsContainer" class="wheels-container"></div>
                
                <!-- è½¬ç›˜æ¨¡æ€æ¡† -->
                <div id="wheelModal" class="modal">
                    <div class="modal-content large">
                        <span class="close">&times;</span>
                        <h3 id="wheelTitle">è½¬ç›˜</h3>
                        <div class="wheel-container">
                            <canvas id="wheelCanvas" width="400" height="400"></canvas>
                            <div id="wheelResult" class="wheel-result"></div>
                        </div>
                        <div class="wheel-controls">
                            <button id="spinBtn" class="btn-primary">å¼€å§‹è½¬åŠ¨</button>
                            <button id="resetWheelBtn" class="btn-secondary">é‡ç½®</button>
                        </div>
                    </div>
                </div>
                
                <!-- åˆ›å»ºè½¬ç›˜æ¨¡æ€æ¡† -->
                <div id="createWheelModal" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h3>åˆ›å»ºè½¬ç›˜</h3>
                        <form id="createWheelForm">
                            <label for="wheelName" style="display: block; margin-bottom: 5px; font-weight: 600;">è½¬ç›˜åç§°:</label>
                            <input type="text" id="wheelName" placeholder="è½¬ç›˜åç§°" required>
                            <textarea id="wheelItems" placeholder="è¾“å…¥é€‰é¡¹ï¼Œæ¯è¡Œä¸€ä¸ª" rows="6" required></textarea>
                            <button type="submit">åˆ›å»ºè½¬ç›˜</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // GitHub Pages ä¸“ç”¨ä¸»è„šæœ¬
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ GitHub Pages ç‰ˆæœ¬åŠ è½½æˆåŠŸ');
            
            // å…¨å±€çŠ¶æ€
            let currentUser = null;
            let currentTab = 'lists';
            
            // åˆå§‹åŒ–
            initAuth();
            
            // è®¤è¯ç›¸å…³åŠŸèƒ½
            function initAuth() {
                // æ£€æŸ¥ç™»å½•çŠ¶æ€
                if (authAPI.isLoggedIn()) {
                    currentUser = authAPI.getCurrentUser();
                    showMainSection();
                } else {
                    showAuthSection();
                }
                
                // ç™»å½•è¡¨å•
                document.getElementById('loginForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const username = document.getElementById('loginUsername').value;
                    const password = document.getElementById('loginPassword').value;
                    
                    try {
                        const result = await authAPI.login(username, password);
                        if (result.success) {
                            currentUser = result.user;
                            showMainSection();
                            console.log('ç™»å½•æˆåŠŸï¼');
                        } else {
                            console.log('ç™»å½•å¤±è´¥ï¼š' + result.message);
                        }
                    } catch (error) {
                        console.error('ç™»å½•é”™è¯¯ï¼š' + error.message);
                    }
                });
                
                // æ³¨å†Œè¡¨å•
                document.getElementById('registerForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const username = document.getElementById('registerUsername').value;
                    const password = document.getElementById('registerPassword').value;
                    const confirmPassword = document.getElementById('registerConfirmPassword').value;
                    
                    if (password !== confirmPassword) {
                        console.log('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´ï¼');
                        return;
                    }
                    
                    try {
                        const result = await authAPI.register(username, password);
                        if (result.success) {
                            currentUser = result.user;
                            showMainSection();
                            console.log('æ³¨å†ŒæˆåŠŸï¼');
                        } else {
                            console.log('æ³¨å†Œå¤±è´¥ï¼š' + result.message);
                        }
                    } catch (error) {
                        console.error('æ³¨å†Œé”™è¯¯ï¼š' + error.message);
                    }
                });
                
                // æ ‡ç­¾åˆ‡æ¢
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const tab = this.dataset.tab;
                        switchAuthTab(tab);
                    });
                });
                
                // é€€å‡ºç™»å½•
                document.getElementById('logoutBtn').addEventListener('click', function() {
                    authAPI.logout();
                    currentUser = null;
                    showAuthSection();
                });
            }
            
            function switchAuthTab(tab) {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.auth-form').forEach(form => form.style.display = 'none');
                
                document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
                document.getElementById(tab + 'Tab').style.display = 'block';
            }
            
            function showAuthSection() {
                document.getElementById('authSection').style.display = 'block';
                document.getElementById('mainSection').style.display = 'none';
                document.getElementById('logoutBtn').style.display = 'none';
            }
            
            function showMainSection() {
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('mainSection').style.display = 'block';
                document.getElementById('logoutBtn').style.display = 'inline-block';
                
                if (currentUser) {
                    document.getElementById('currentUser').textContent = currentUser.username;
                }
                
                // åˆå§‹åŒ–ä¸»åŠŸèƒ½
                initMainFeatures();
            }
            
            // ä¸»åŠŸèƒ½åˆå§‹åŒ–
            function initMainFeatures() {
                // å¯¼èˆªæ ‡ç­¾åˆ‡æ¢
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', function() {
                        const tabName = this.dataset.tab;
                        switchTab(tabName);
                    });
                });
                
                // åˆå§‹åŒ–å„åŠŸèƒ½æ¨¡å—
                initLists();
                initNotes();
                initExercises();
                initCuisine();
                initWheel();
                
                // æ¨¡æ€æ¡†å…³é—­åŠŸèƒ½
                document.querySelectorAll('.close').forEach(closeBtn => {
                    closeBtn.addEventListener('click', function() {
                        this.closest('.modal').style.display = 'none';
                    });
                });
            }
            
            function switchTab(tabName) {
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                document.getElementById(tabName + 'Tab').classList.add('active');
                
                currentTab = tabName;
            }
            
            // æ¸…å•åŠŸèƒ½
            function initLists() {
                loadLists();
                
                document.getElementById('createListBtn').addEventListener('click', function() {
                    document.getElementById('createListModal').style.display = 'block';
                });
                
                document.getElementById('createListForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const name = document.getElementById('listName').value;
                    const description = document.getElementById('listDescription').value;
                    
                    try {
                        await sharedListsAPI.createList(name, description);
                        document.getElementById('createListModal').style.display = 'none';
                        document.getElementById('createListForm').reset();
                        loadLists();
                        alert('æ¸…å•åˆ›å»ºæˆåŠŸï¼');
                    } catch (error) {
                        alert('åˆ›å»ºæ¸…å•å¤±è´¥ï¼š' + error.message);
                    }
                });
            }
            
            async function loadLists() {
                try {
                    const result = await sharedListsAPI.getLists();
                    const lists = result.data || [];
                    const container = document.getElementById('listsContainer');
                    
                    if (lists.length === 0) {
                        container.innerHTML = '<p class="empty-message">æš‚æ— æ¸…å•ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªæ¸…å•</p>';
                        return;
                    }
                    
                    container.innerHTML = lists.map(list => `
                        <div class="list-item">
                            <h4>${list.name}</h4>
                            <p>${list.description || 'æ— æè¿°'}</p>
                            <div class="list-actions">
                                <button class="btn-secondary" onclick="viewList(${list.id})">æŸ¥çœ‹è¯¦æƒ…</button>
                                <button class="btn-danger" onclick="deleteList(${list.id})">åˆ é™¤</button>
                            </div>
                        </div>
                    `).join('');
                } catch (error) {
                    console.error('åŠ è½½æ¸…å•å¤±è´¥:', error);
                    document.getElementById('listsContainer').innerHTML = '<p class="error-message">åŠ è½½æ¸…å•å¤±è´¥</p>';
                }
            }
            
            // ç¬”è®°åŠŸèƒ½
            function initNotes() {
                const noteDate = document.getElementById('noteDate');
                const today = new Date().toISOString().split('T')[0];
                noteDate.value = today;
                
                loadNote(today);
                
                noteDate.addEventListener('change', function() {
                    loadNote(this.value);
                });
                
                document.getElementById('saveNoteBtn').addEventListener('click', async function() {
                    const date = noteDate.value;
                    const content = document.getElementById('noteContent').value;
                    
                    try {
                        await notesAPI.saveNote(date, content);
                        alert('ç¬”è®°ä¿å­˜æˆåŠŸï¼');
                    } catch (error) {
                        alert('ä¿å­˜ç¬”è®°å¤±è´¥ï¼š' + error.message);
                    }
                });
                
                document.getElementById('clearNoteBtn').addEventListener('click', function() {
                    document.getElementById('noteContent').value = '';
                });
            }
            
            async function loadNote(date) {
                try {
                    const result = await notesAPI.getNote(date);
                    document.getElementById('noteContent').value = result.data.content || '';
                } catch (error) {
                    console.error('åŠ è½½ç¬”è®°å¤±è´¥:', error);
                    document.getElementById('noteContent').value = '';
                }
            }
            
            // è¿åŠ¨åŠŸèƒ½
            function initExercises() {
                loadExercises();
                
                document.getElementById('addExerciseBtn').addEventListener('click', function() {
                    document.getElementById('addExerciseModal').style.display = 'block';
                });
                
                document.getElementById('addExerciseForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const name = document.getElementById('exerciseName').value;
                    const type = document.getElementById('exerciseType').value;
                    const duration = parseInt(document.getElementById('exerciseDuration').value);
                    const intensity = document.getElementById('exerciseIntensity').value;
                    
                    try {
                        await exercisesAPI.createExercise(name, type, duration, intensity);
                        document.getElementById('addExerciseModal').style.display = 'none';
                        document.getElementById('addExerciseForm').reset();
                        loadExercises();
                        alert('è¿åŠ¨æ·»åŠ æˆåŠŸï¼');
                    } catch (error) {
                        alert('æ·»åŠ è¿åŠ¨å¤±è´¥ï¼š' + error.message);
                    }
                });
            }
            
            async function loadExercises() {
                try {
                    const result = await exercisesAPI.getExercises();
                    const exercises = result.data || [];
                    const container = document.getElementById('exercisesContainer');
                    
                    if (exercises.length === 0) {
                        container.innerHTML = '<p class="empty-message">æš‚æ— è¿åŠ¨è®°å½•ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªè¿åŠ¨</p>';
                        return;
                    }
                    
                    container.innerHTML = exercises.map(exercise => `
                        <div class="exercise-item">
                            <h4>${exercise.name}</h4>
                            <p>ç±»å‹: ${exercise.type}</p>
                            <p>æ—¶é•¿: ${exercise.duration}åˆ†é’Ÿ</p>
                            <p>å¼ºåº¦: ${exercise.intensity}</p>
                            <div class="exercise-actions">
                                <button class="btn-danger" onclick="deleteExercise(${exercise.id})">åˆ é™¤</button>
                            </div>
                        </div>
                    `).join('');
                } catch (error) {
                    console.error('åŠ è½½è¿åŠ¨å¤±è´¥:', error);
                    document.getElementById('exercisesContainer').innerHTML = '<p class="error-message">åŠ è½½è¿åŠ¨å¤±è´¥</p>';
                }
            }
            
            // é¥®é£ŸåŠŸèƒ½
            function initCuisine() {
                loadCuisines();
                
                document.getElementById('addCuisineBtn').addEventListener('click', function() {
                    document.getElementById('addCuisineModal').style.display = 'block';
                });
                
                document.getElementById('addCuisineForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const name = document.getElementById('cuisineName').value;
                    const type = document.getElementById('cuisineType').value;
                    const calories = parseInt(document.getElementById('cuisineCalories').value);
                    const date = document.getElementById('cuisineDate').value;
                    
                    try {
                        await cuisineAPI.createCuisine(name, type, calories, date);
                        document.getElementById('addCuisineModal').style.display = 'none';
                        document.getElementById('addCuisineForm').reset();
                        loadCuisines();
                        alert('é¥®é£Ÿæ·»åŠ æˆåŠŸï¼');
                    } catch (error) {
                        alert('æ·»åŠ é¥®é£Ÿå¤±è´¥ï¼š' + error.message);
                    }
                });
            }
            
            async function loadCuisines() {
                try {
                    const result = await cuisineAPI.getCuisines();
                    const cuisines = result.data || [];
                    const container = document.getElementById('cuisineContainer');
                    
                    if (cuisines.length === 0) {
                        container.innerHTML = '<p class="empty-message">æš‚æ— é¥®é£Ÿè®°å½•ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªé¥®é£Ÿ</p>';
                        return;
                    }
                    
                    container.innerHTML = cuisines.map(cuisine => `
                        <div class="cuisine-item">
                            <h4>${cuisine.name}</h4>
                            <p>ç±»å‹: ${cuisine.type}</p>
                            <p>å¡è·¯é‡Œ: ${cuisine.calories}</p>
                            <p>æ—¥æœŸ: ${cuisine.date}</p>
                            <div class="cuisine-actions">
                                <button class="btn-danger" onclick="deleteCuisine(${cuisine.id})">åˆ é™¤</button>
                            </div>
                        </div>
                    `).join('');
                } catch (error) {
                    console.error('åŠ è½½é¥®é£Ÿå¤±è´¥:', error);
                    document.getElementById('cuisineContainer').innerHTML = '<p class="error-message">åŠ è½½é¥®é£Ÿå¤±è´¥</p>';
                }
            }
            
            // è½¬ç›˜åŠŸèƒ½
            function initWheel() {
                loadWheels();
                
                document.getElementById('createWheelBtn').addEventListener('click', function() {
                    document.getElementById('createWheelModal').style.display = 'block';
                });
                
                document.getElementById('createWheelForm').addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const name = document.getElementById('wheelName').value;
                    const itemsText = document.getElementById('wheelItems').value;
                    const items = itemsText.split('\n').filter(item => item.trim());
                    
                    if (items.length < 2) {
                        alert('è‡³å°‘éœ€è¦2ä¸ªé€‰é¡¹');
                        return;
                    }
                    
                    try {
                        await wheelAPI.createWheel(name, items);
                        document.getElementById('createWheelModal').style.display = 'none';
                        document.getElementById('createWheelForm').reset();
                        loadWheels();
                        alert('è½¬ç›˜åˆ›å»ºæˆåŠŸï¼');
                    } catch (error) {
                        alert('åˆ›å»ºè½¬ç›˜å¤±è´¥ï¼š' + error.message);
                    }
                });
            }
            
            async function loadWheels() {
                try {
                    const result = await wheelAPI.getWheels();
                    const wheels = result.data || [];
                    const container = document.getElementById('wheelsContainer');
                    
                    if (wheels.length === 0) {
                        container.innerHTML = '<p class="empty-message">æš‚æ— è½¬ç›˜ï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªè½¬ç›˜</p>';
                        return;
                    }
                    
                    container.innerHTML = wheels.map(wheel => `
                        <div class="wheel-item">
                            <h4>${wheel.name}</h4>
                            <p>é€‰é¡¹æ•°: ${wheel.items.length}</p>
                            <div class="wheel-actions">
                                <button class="btn-primary" onclick="openWheel(${wheel.id})">å¼€å§‹è½¬åŠ¨</button>
                                <button class="btn-danger" onclick="deleteWheel(${wheel.id})">åˆ é™¤</button>
                            </div>
                        </div>
                    `).join('');
                } catch (error) {
                    console.error('åŠ è½½è½¬ç›˜å¤±è´¥:', error);
                    document.getElementById('wheelsContainer').innerHTML = '<p class="error-message">åŠ è½½è½¬ç›˜å¤±è´¥</p>';
                }
            }
            
            // å…¨å±€å‡½æ•°ä¾›HTMLè°ƒç”¨
            window.viewList = function(listId) {
                alert('æŸ¥çœ‹æ¸…å•è¯¦æƒ…åŠŸèƒ½å¼€å‘ä¸­...');
            };
            
            window.deleteList = async function(listId) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¸…å•å—ï¼Ÿ')) {
                    try {
                        await sharedListsAPI.deleteList(listId);
                        loadLists();
                        alert('æ¸…å•åˆ é™¤æˆåŠŸï¼');
                    } catch (error) {
                        alert('åˆ é™¤æ¸…å•å¤±è´¥ï¼š' + error.message);
                    }
                }
            };
            
            window.deleteExercise = async function(id) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è¿åŠ¨è®°å½•å—ï¼Ÿ')) {
                    try {
                        await exercisesAPI.deleteExercise(id);
                        loadExercises();
                        alert('è¿åŠ¨è®°å½•åˆ é™¤æˆåŠŸï¼');
                    } catch (error) {
                        alert('åˆ é™¤è¿åŠ¨è®°å½•å¤±è´¥ï¼š' + error.message);
                    }
                }
            };
            
            window.deleteCuisine = async function(id) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡é¥®é£Ÿè®°å½•å—ï¼Ÿ')) {
                    try {
                        await cuisineAPI.deleteCuisine(id);
                        loadCuisines();
                        alert('é¥®é£Ÿè®°å½•åˆ é™¤æˆåŠŸï¼');
                    } catch (error) {
                        alert('åˆ é™¤é¥®é£Ÿè®°å½•å¤±è´¥ï¼š' + error.message);
                    }
                }
            };
            
            window.playWheel = function(id) {
                alert('è½¬ç›˜åŠŸèƒ½å¼€å‘ä¸­...');
            };
            
            window.deleteWheel = async function(id) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè½¬ç›˜å—ï¼Ÿ')) {
                    try {
                        await wheelAPI.deleteWheel(id);
                        loadWheels();
                        alert('è½¬ç›˜åˆ é™¤æˆåŠŸï¼');
                    } catch (error) {
                        alert('åˆ é™¤è½¬ç›˜å¤±è´¥ï¼š' + error.message);
                    }
                }
            };
        });
    </script>
</body>
</html>